# 菜单管理模块测试指南

## 📋 测试概述

菜单管理模块是系统的核心功能之一，负责管理系统的菜单结构、权限控制和用户界面导航。本指南将帮助你全面测试菜单管理的各项功能。

## 🎯 测试目标

1. **功能测试**：验证菜单的增删改查功能
2. **权限测试**：验证菜单权限控制机制
3. **界面测试**：验证前端菜单管理界面
4. **数据完整性测试**：验证菜单数据的一致性
5. **安全测试**：验证核心菜单保护机制

## 🔧 测试环境准备

### 1. 启动系统
```bash
# 启动后端服务
./mvnw spring-boot:run

# 启动前端服务
cd frontend
npm run dev
```

### 2. 登录系统
- 使用管理员账号登录：`admin / admin123`
- 确保有菜单管理权限

## 📝 测试用例

### A. 基础功能测试

#### A1. 查看菜单列表
**测试步骤**：
1. 登录系统
2. 进入 "系统管理" → "菜单管理"
3. 查看菜单树形结构

**预期结果**：
- ✅ 显示完整的菜单树
- ✅ 可以展开/折叠菜单节点
- ✅ 菜单信息显示完整（名称、编码、类型、状态等）
- ✅ 核心菜单有"核心"标签

#### A2. 新增顶级菜单
**测试步骤**：
1. 点击"新增顶级菜单"按钮
2. 填写菜单信息：
   - 菜单名称：测试目录
   - 菜单编码：test-catalog
   - 菜单类型：目录
   - 路由地址：/test
   - 图标：Setting
   - 排序：999
3. 点击确定

**预期结果**：
- ✅ 成功创建新菜单
- ✅ 菜单列表中显示新菜单
- ✅ 菜单信息正确

#### A3. 新增子菜单
**测试步骤**：
1. 在刚创建的"测试目录"上点击"添加子菜单"
2. 填写子菜单信息：
   - 菜单名称：测试页面
   - 菜单编码：test-page
   - 菜单类型：菜单
   - 路由地址：/test/page
   - 组件路径：views/test/TestPage.vue
   - 排序：1
3. 点击确定

**预期结果**：
- ✅ 成功创建子菜单
- ✅ 子菜单正确归属于父菜单
- ✅ 树形结构正确

#### A4. 编辑菜单
**测试步骤**：
1. 点击菜单的"编辑"按钮
2. 修改菜单名称为"测试目录（修改）"
3. 修改排序为998
4. 点击确定

**预期结果**：
- ✅ 菜单信息更新成功
- ✅ 显示更新后的信息

#### A5. 切换菜单状态
**测试步骤**：
1. 点击菜单的"禁用"按钮
2. 确认禁用操作
3. 再次点击"启用"按钮

**预期结果**：
- ✅ 菜单状态成功切换
- ✅ 状态标签正确显示

#### A6. 删除菜单
**测试步骤**：
1. 先删除子菜单"测试页面"
2. 再删除父菜单"测试目录（修改）"

**预期结果**：
- ✅ 有子菜单时不能删除父菜单
- ✅ 删除子菜单后可以删除父菜单
- ✅ 菜单从列表中消失

### B. 权限控制测试

#### B1. 核心菜单保护测试
**测试步骤**：
1. 尝试删除"系统管理"菜单
2. 尝试禁用"用户管理"菜单
3. 尝试修改"菜单管理"的编码

**预期结果**：
- ✅ 核心菜单删除按钮禁用或无法删除
- ✅ 核心菜单禁用按钮禁用或无法禁用
- ✅ 核心菜单编码无法修改

#### B2. 菜单编码唯一性测试
**测试步骤**：
1. 创建一个菜单，编码为"test-unique"
2. 再次创建菜单，使用相同编码

**预期结果**：
- ✅ 第二次创建失败
- ✅ 显示"菜单编码已存在"错误提示

### C. 界面交互测试

#### C1. 展开折叠功能
**测试步骤**：
1. 点击"展开全部"按钮
2. 点击"折叠全部"按钮
3. 手动点击单个菜单节点展开/折叠

**预期结果**：
- ✅ 所有菜单节点正确展开/折叠
- ✅ 树形结构显示正常

#### C2. 表单验证测试
**测试步骤**：
1. 新增菜单时不填写必填字段
2. 填写无效的数据格式

**预期结果**：
- ✅ 显示相应的验证错误提示
- ✅ 无法提交无效数据

## 🧪 API接口测试

### 使用测试脚本
运行提供的API测试脚本：
```bash
python test_menu_api.py
```

### 手动API测试
可以使用Postman或curl测试以下接口：

1. **获取菜单树**：`GET /api/sys/menus/tree`
2. **创建菜单**：`POST /api/sys/menus`
3. **更新菜单**：`PUT /api/sys/menus/{id}`
4. **删除菜单**：`DELETE /api/sys/menus/{id}`
5. **切换状态**：`PUT /api/sys/menus/{id}/toggle-status`

## 📊 测试数据场景

### 场景1：完整的菜单层级
- 顶级目录 → 二级菜单 → 按钮权限

### 场景2：权限分配测试
- 不同角色用户看到不同的菜单

### 场景3：边界条件测试
- 超长菜单名称
- 特殊字符处理
- 深层级菜单嵌套

## ✅ 测试检查清单

### 功能完整性
- [ ] 菜单增删改查功能正常
- [ ] 树形结构构建正确
- [ ] 父子关系维护正确
- [ ] 排序功能正常

### 权限安全性
- [ ] 核心菜单保护生效
- [ ] 权限控制正确
- [ ] 数据验证有效

### 用户体验
- [ ] 界面响应流畅
- [ ] 操作反馈及时
- [ ] 错误提示清晰

### 数据一致性
- [ ] 数据库数据正确
- [ ] 前后端数据同步
- [ ] 关联关系完整

## 🐛 常见问题排查

### 问题1：菜单不显示
- 检查菜单状态是否启用
- 检查用户权限是否足够
- 检查数据库数据是否正确

### 问题2：操作按钮不显示
- 检查用户权限配置
- 检查权限代码是否正确

### 问题3：树形结构异常
- 检查parentId字段是否正确
- 检查是否有循环引用

## 📞 测试支持

如果测试过程中遇到问题，可以：
1. 查看浏览器控制台错误信息
2. 查看后端日志
3. 检查数据库数据状态
4. 参考本指南的问题排查部分

---

**测试完成标准**：所有测试用例通过，功能正常，无阻塞性问题。 