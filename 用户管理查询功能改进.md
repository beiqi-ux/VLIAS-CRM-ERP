# 用户管理查询功能改进

## 功能改进说明

### 1. 后端改进

#### 用户控制器 (SysUserController.java)
- **新增功能**：支持分页和条件查询
- **查询参数**：
  - `page`: 页码（默认1）
  - `size`: 每页大小（默认10）
  - `username`: 用户名模糊查询
  - `realName`: 真实姓名模糊查询
  - `status`: 状态查询（1-启用，0-禁用）

#### 用户Repository (SysUserRepository.java)
- **新增接口**：继承`JpaSpecificationExecutor<SysUser>`
- **支持功能**：动态条件查询和分页

### 2. 前端改进

#### 搜索表单
- **回车查询**：在用户名和真实姓名字段按回车键即可触发搜索
- **清空功能**：支持清空输入框内容
- **状态筛选**：支持按用户状态筛选

#### 数据处理
- **分页处理**：正确处理后端返回的分页数据
- **数据展示**：优化了用户列表的显示

## 使用方法

### 1. 基本查询
1. 在"用户名"输入框中输入用户名（支持模糊查询）
2. 在"真实姓名"输入框中输入姓名（支持模糊查询）
3. 在"状态"下拉框中选择用户状态
4. 点击"搜索"按钮或按回车键进行查询

### 2. 回车查询
- 在用户名输入框中输入内容后按回车键
- 在真实姓名输入框中输入内容后按回车键
- 系统会自动触发搜索功能

### 3. 重置功能
- 点击"重置"按钮可以清空所有搜索条件
- 重置后会自动刷新用户列表

### 4. 分页功能
- 支持每页显示10、20、50、100条记录
- 支持页码跳转
- 显示总记录数和当前页信息

## 技术实现

### 后端实现
```java
// 支持动态查询条件
Specification<SysUser> spec = (root, query, criteriaBuilder) -> {
    List<Predicate> predicates = new ArrayList<>();
    
    // 用户名模糊查询
    if (username != null && !username.trim().isEmpty()) {
        predicates.add(criteriaBuilder.like(root.get("username"), "%" + username + "%"));
    }
    
    // 真实姓名模糊查询
    if (realName != null && !realName.trim().isEmpty()) {
        predicates.add(criteriaBuilder.like(root.get("realName"), "%" + realName + "%"));
    }
    
    // 状态查询
    if (status != null) {
        predicates.add(criteriaBuilder.equal(root.get("status"), status));
    }
    
    return criteriaBuilder.and(predicates.toArray(new Predicate[0]));
};
```

### 前端实现
```vue
<!-- 回车查询 -->
<el-input 
  v-model="searchForm.username" 
  placeholder="请输入用户名" 
  clearable 
  @keyup.enter="handleSearch"
/>

<!-- 搜索处理 -->
const handleSearch = () => {
  pagination.current = 1
  fetchUserList()
}
```

## 返回数据格式

### 成功响应
```json
{
  "success": true,
  "data": {
    "data": [
      {
        "id": 1,
        "username": "admin",
        "realName": "系统管理员",
        "mobile": "13800138000",
        "email": "admin@example.com",
        "status": 1,
        "createTime": "2024-01-01 00:00:00"
      }
    ],
    "total": 100,
    "current": 1,
    "size": 10,
    "pages": 10
  }
}
```

## 注意事项

1. **查询性能**：用户名和真实姓名使用模糊查询，大数据量时建议添加索引
2. **安全性**：返回的用户数据中密码字段会被清空
3. **分页参数**：页码从1开始，后端会自动转换为从0开始的索引
4. **状态值**：1表示启用，0表示禁用

## 后续优化建议

1. **高级搜索**：添加更多搜索条件（如邮箱、手机号等）
2. **排序功能**：支持按不同字段排序
3. **导出功能**：支持导出查询结果
4. **批量操作**：支持批量删除、批量修改状态等
5. **缓存优化**：对常用查询结果进行缓存

现在用户管理模块的查询功能已经完全可用，支持回车查询和条件筛选！ 